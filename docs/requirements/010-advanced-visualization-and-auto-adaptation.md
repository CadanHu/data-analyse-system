# 需求文档 010：多维进阶可视化与系统自动适配方案

## 1. 背景 (Background)
随着业务分析需求的复杂化，仅支持基础的柱状图、折线图和饼图已无法满足深度数据洞察的需求。用户需要更丰富的图表类型（如雷达图、漏斗图、预测趋势等）来直观展示多维数据关系。

## 2. 核心修改 (Core Changes)

### 2.1 可视化引擎升级
- **扩展图表库**：新增支持面积图、散点图、雷达图、漏斗图、仪表盘、热力图、树状图、桑基图、箱线图、瀑布图、蜡烛图等 15+ 种进阶图表。
- **AI 配置驱动**：后端 `SQLAgent` 引入 `CHART_CONFIG_PROMPT`，利用 AI 动态生成复杂的 ECharts Option，实现“数据 -> 图表”的无缝自动映射。
- **美学标准规范**：统一所有图表的交互规范（Tooltip、平滑曲线、圆角处理、配色方案）。

### 2.2 提示词工程重构
- **SQL 生成增强**：`SQL_GENERATION_PROMPT` 新增图表选择准则，使 AI 能根据数据特征自动匹配最佳展示类型（如时间序列选 line/area，多维对比选 radar）。
- **可视化意图识别**：新增 `viz_config` 解析，支持 X/Y 轴自动映射及多指标展示。

### 2.3 前端展示适配
- **动态控制面板**：前端 `RightPanel` 扩展图表切换菜单，支持“智能推荐”与手动强制切换。
- **增强型降级方案**：`fallbackGenerateChart` 支持更多类型的自动推断渲染，确保在 AI 配置不可用时仍有基础展示。

## 3. 验证标准 (Verification)
- [ ] 提问“分析销售额趋势并使用面积图展示”，系统应自动生成 `chart_type: "area"` 并正确渲染面积图。
- [ ] 提问“多维度对比产品性能”，系统应自动选择 `radar` 图。
- [ ] 检查 `RightPanel` 是否包含新增的 10 种可视化选项。
- [ ] 验证 KPI 类查询（如总销售额）是否依然准确触发 `card` 展示。

## 4. 影响范围 (Impact)
- 后端：`SQLAgent`, `prompt_templates.py`
- 前端：`RightPanel`, `EChartsRenderer`
- 文档：`README.md`, `LOCAL_INSTALLATION.md`
