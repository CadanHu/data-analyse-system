# å·²çŸ¥ Bug åˆ—è¡¨

## ğŸ› è®¤è¯ç›¸å…³ Bug

### Bug 1: ç™»å½•å Token æœªæ­£ç¡®é™„åŠ åˆ°åç»­è¯·æ±‚

**æ–‡ä»¶**: `frontend/src/pages/Login.tsx`, `frontend/src/api/index.ts`

**é—®é¢˜æè¿°**: 
- ç™»å½•æˆåŠŸåè°ƒç”¨ `/api/auth/me` è¿”å› 401 Unauthorized
- Zustand çš„ `persist` ä¸­é—´ä»¶æ˜¯å¼‚æ­¥çš„ï¼Œ`setAuth()` å store ä¸ä¼šç«‹å³æ›´æ–°
- axios è¯·æ±‚æ‹¦æˆªå™¨æ— æ³•è·å–åˆ° Token

**å½“å‰ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**:
```typescript
// åœ¨ Login.tsx ä¸­æ‰‹åŠ¨è®¾ç½® axios é»˜è®¤ header
const axios = (await import('axios')).default
axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`
```

**éœ€è¦ä¿®å¤**:
- æ‰¾åˆ°æ­£ç¡®çš„åŒæ­¥æ–¹å¼è®¾ç½® Token
- æˆ–è€…è°ƒæ•´ zustand persist çš„é…ç½®
- æˆ–è€…åœ¨ API è°ƒç”¨å‰ç¡®ä¿ store å·²æ›´æ–°

**ç›¸å…³æ–‡ä»¶**:
- `frontend/src/pages/Login.tsx` - ç™»å½•é€»è¾‘
- `frontend/src/api/index.ts` - axios æ‹¦æˆªå™¨
- `frontend/src/stores/authStore.ts` - Zustand store

---

### Bug 2: æ³¨å†Œæ—¶ç”¨æˆ·åè¢«è®¾ç½®ä¸ºéªŒè¯ç 

**æ–‡ä»¶**: å‰ç«¯æ³¨å†Œè¡¨å•

**é—®é¢˜æè¿°**:
- ç”¨æˆ·æŠ¥å‘Šæ³¨å†Œåç”¨æˆ·åä¸ºéªŒè¯ç ï¼ˆå¦‚ `123456`ï¼‰è€Œä¸æ˜¯çœŸæ­£çš„ç”¨æˆ·å
- æ•°æ®åº“ä¸­å­˜å‚¨çš„ `username` å­—æ®µå€¼ä¸ºéªŒè¯ç 

**å¯èƒ½åŸå› **:
- å‰ç«¯è¡¨å•å­—æ®µç»‘å®šé”™è¯¯
- ç”¨æˆ·å¡«å†™æ—¶æ··æ·†äº†å­—æ®µ

**çŠ¶æ€**: å¾…è°ƒæŸ¥

---

## ğŸ› é…ç½®ç›¸å…³ Bug

### Bug 3: æœ¬åœ°æµ‹è¯•é…ç½®ä¼šè¢«æäº¤åˆ° Git

**æ–‡ä»¶**: `frontend/vite.config.ts`, `frontend/src/api/index.ts`

**é—®é¢˜æè¿°**:
- æœ¬åœ°æµ‹è¯•éœ€è¦ä¿®æ”¹ç«¯å£é…ç½®ï¼ˆ5188/8008ï¼‰
- è¿™äº›ä¿®æ”¹ä¸åº”è¯¥æäº¤åˆ° Git

**å½“å‰è§£å†³æ–¹æ¡ˆ**:
- åˆ›å»ºäº† `.local.ts` æ–‡ä»¶å¹¶åœ¨ `.gitignore` ä¸­å¿½ç•¥
- ä½†ä¸»é…ç½®æ–‡ä»¶ä»å¯èƒ½è¢«è¯¯ä¿®æ”¹

**éœ€è¦ä¿®å¤**:
- ç¡®ä¿æ‰€æœ‰æœ¬åœ°é…ç½®æ–‡ä»¶éƒ½è¢«æ­£ç¡®å¿½ç•¥
- æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®

---

## ğŸ“ è°ƒè¯•æ—¥å¿—

å½“å‰åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼š

### åç«¯æ—¥å¿—
- `backend/routers/auth_router.py` - å®Œæ•´çš„è®¤è¯æµç¨‹æ—¥å¿—
  - æ³¨å†Œæµç¨‹ï¼ˆæ­¥éª¤ 1-3ï¼‰
  - ç™»å½•æµç¨‹ï¼ˆæŸ¥æ‰¾ç”¨æˆ·ã€éªŒè¯å¯†ç ã€åˆ›å»º Tokenï¼‰
  - Token éªŒè¯æµç¨‹

### å‰ç«¯æ—¥å¿—
- `frontend/src/pages/Login.tsx` - ç™»å½•æµç¨‹æ—¥å¿—
- `frontend/src/api/index.ts` - API è¯·æ±‚/å“åº”æ—¥å¿—
- `frontend/src/api/index.ts` - axios æ‹¦æˆªå™¨æ—¥å¿—

---

## ğŸ”§ æœ¬åœ°æµ‹è¯•é…ç½®

### åç«¯é…ç½®
```bash
cd backend
source venv/bin/activate
python3 -m uvicorn main:app --host 0.0.0.0 --port 8008 --reload
```

### å‰ç«¯é…ç½®
```bash
cd frontend
# ä½¿ç”¨æœ¬åœ°é…ç½®å¯åŠ¨
npm run dev -- --config vite.config.local.ts --port 5188
```

### ç¯å¢ƒå˜é‡
- åç«¯ï¼š`backend/.env` - `USE_MYSQL_FOR_SESSIONS=true`
- æ•°æ®åº“ï¼šMySQL `data_pulse_sessions`

---

## ğŸ“‹ å¾…åŠäº‹é¡¹

1. **ä¿®å¤ Token åŒæ­¥é—®é¢˜** - æœ€é«˜ä¼˜å…ˆçº§
2. **æ¸…ç†è°ƒè¯•æ—¥å¿—** - ç”Ÿäº§ç¯å¢ƒåº”ç§»é™¤ console.log
3. **æµ‹è¯•ç§»åŠ¨ç«¯ API è¿æ¥** - iOS/Android ç«¯
4. **æ·»åŠ é”™è¯¯è¾¹ç•Œå¤„ç†** - ç½‘ç»œé”™è¯¯ã€Token è¿‡æœŸç­‰
5. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ** - åŠ è½½çŠ¶æ€ã€é”™è¯¯æç¤º

---

**æœ€åæ›´æ–°**: 2026-02-28
**ç‰ˆæœ¬**: v1.7.0
